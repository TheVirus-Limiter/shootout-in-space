<head>
    <title>Shootout in Space</title>
    <link rel="icon" type="image/x-icon" href="https://media.discordapp.net/attachments/1046544304799227984/1046545074185568296/logo.jpg">
    <meta charset="UTF-8">
      <meta name="description" content="A fun retro arcade styled space shooting game with a shop, upgrades and more!">
      <meta name="keywords" content="Javascript, Shootout, Space, Game, Fun">
      <meta name="author" content="Rehan Raj">
    </head>


      
<canvas id="myCanvas"></canvas>
    <script type="module">
      
  //var w = window.innerWidth;
  //var h = window.innerHeight;
  //var chromebook = false;
        // import kaboom lib
        import kaboom from "https://unpkg.com/kaboom/dist/kaboom.mjs";
        
        // initialize kaboom context
        //kaboom();
        
    
 

    /*kaboom({
      //1366 x 784
        //width: 768,
        //height: 361,
      //height:h,
      //width:w,
        scale:1,
        scaleMode: "stretch",
        fullscreen: true,
        font: "sinko",
        canvas: document.querySelector("#myCanvas"),
        background: [ 0, 0, 0 ],
    });*/


    kaboom({
      //1366 x 784
        width: 1920,
        height: 929,
      //height:h,
      //width:w,
        //scale:0.68,
        scaleMode: "stretch",
        //fullscreen: true,
        font: "sinko",
        canvas: document.querySelector("#myCanvas"),
        background: [ 0, 0, 0 ],
    });

  

      
      //debug.log("width: "+ w + " height: " +h)
    loadSprite("ufo", "https://cdn-icons-png.flaticon.com/512/1008/1008165.png")
    loadSprite("backg", "https://thevirus-limiter.github.io/shootout-in-space/sprites/bg_space_seamless.png")
    loadSprite("grass1", "https://thevirus-limiter.github.io/shootout-in-space/sprites/grass1.png")
    loadSprite("coin", "https://cdn-icons-png.flaticon.com/512/409/409065.png");
    loadSprite("timer", "https://cdn-icons-png.flaticon.com/512/465/465229.png")
    loadSprite("heart", "https://cdn-icons-png.flaticon.com/512/8236/8236748.png")
    loadSprite("blueheart", "https://thevirus-limiter.github.io/shootout-in-space/sprites/blueheart.png")
    loadSprite("soundOn", "https://cdn-icons-png.flaticon.com/512/189/189650.png")
    loadSprite("soundOff", "https://cdn-icons-png.flaticon.com/512/189/189653.png")
    loadSprite("comet", "https://thevirus-limiter.github.io/shootout-in-space/sprites/ufo.png")
    loadSprite("shield", "https://thevirus-limiter.github.io/shootout-in-space/sprites/shield.png")
    loadSprite("logo", "https://thevirus-limiter.github.io/shootout-in-space/sprites/logo.jpg")
    loadSprite("start", "https://thevirus-limiter.github.io/shootout-in-space/sprites/startb.png");
    loadSprite("shop", "https://thevirus-limiter.github.io/shootout-in-space/sprites/shopbutton.png")
    loadSprite("graystart", "https://thevirus-limiter.github.io/shootout-in-space/sprites/graystart.png")
    loadSprite("credits", "https://thevirus-limiter.github.io/shootout-in-space/sprites/creditsbutton.png")
    loadSprite("settings", "https://thevirus-limiter.github.io/shootout-in-space/sprites/settingsbutton.png")
    loadSprite("settingsUI", "https://thevirus-limiter.github.io/shootout-in-space/sprites/settingsUI.jpg")
    loadSprite("defbuy", "https://thevirus-limiter.github.io/shootout-in-space/sprites/defBuy.png")
    loadSprite("1buy", "https://thevirus-limiter.github.io/shootout-in-space/sprites/1Buy.jpg")
    loadSprite("2buy", "https://thevirus-limiter.github.io/shootout-in-space/sprites/2buy.jpg")
    loadSprite("3buy", "https://thevirus-limiter.github.io/shootout-in-space/sprites/3buy.jpg")
    loadSprite("4buy", "https://thevirus-limiter.github.io/shootout-in-space/sprites/4buy.jpg")
    loadSprite("5buy","https://thevirus-limiter.github.io/shootout-in-space/sprites/5buy.jpg")
    loadSprite("bought", "https://thevirus-limiter.github.io/shootout-in-space/sprites/bought.jpg")
    loadSprite("equip", "https://thevirus-limiter.github.io/shootout-in-space/sprites/equip.jpg")
    loadSprite("equipped", "https://thevirus-limiter.github.io/shootout-in-space/sprites/equipped.jpg")
    loadSprite("exit", "https://thevirus-limiter.github.io/shootout-in-space/sprites/exitbutton.png")
    loadSprite("meteor", "https://cdn-icons-png.flaticon.com/512/1137/1137550.png")
    loadSprite("defSkin", "https://cdn-icons-png.flaticon.com/512/3306/3306622.png")
    loadSprite("skin2","https://thevirus-limiter.github.io/shootout-in-space/sprites/skin2.png")
    loadSprite("skin3","https://thevirus-limiter.github.io/shootout-in-space/sprites/skin3.png")
    loadSprite("skin4","https://thevirus-limiter.github.io/shootout-in-space/sprites/skin4.png")
    loadSprite("skin5","https://thevirus-limiter.github.io/shootout-in-space/sprites/skin5.png")
    loadSprite("startImg","https://thevirus-limiter.github.io/shootout-in-space/sprites/tostart.jpg")
    loadSprite("splash","https://thevirus-limiter.github.io/shootout-in-space/sprites/splash.jpg")
    loadSprite("splashBG", "https://thevirus-limiter.github.io/shootout-in-space/sprites/splashBG.png")
    loadSprite("loading","https://thevirus-limiter.github.io/shootout-in-space/sprites/loading.jpg")
    loadSprite("shopUI", "https://thevirus-limiter.github.io/shootout-in-space/sprites/shopUI.png")
    loadSprite("protip","https://thevirus-limiter.github.io/shootout-in-space/sprites/protip.png")
    loadSprite("codesButton","https://thevirus-limiter.github.io/shootout-in-space/sprites/codesButton.png")
    loadSprite("codesUI","https://thevirus-limiter.github.io/shootout-in-space/sprites/codesUI.jpg")
        
    //
    //
    
    loadSound("shoot", "https://thevirus-limiter.github.io/shootout-in-space/sound/blaster-2-81267.mp3")
    loadSound("shoot1", "https://thevirus-limiter.github.io/shootout-in-space/sound/sound-effects-library-laser-gun.mp3")
    loadSound("music", "https://thevirus-limiter.github.io/shootout-in-space/sound/bettogh-helios-beam.mp3")
    loadSound("coinPick", "https://thevirus-limiter.github.io/shootout-in-space/sound/collectcoin-6075.mp3")
    loadSound("lose", "https://thevirus-limiter.github.io/shootout-in-space/sound/gameover.wav")
    loadSound ("comet","https://thevirus-limiter.github.io/shootout-in-space/sound/fire-breath.mp3")
    loadSound ("menuMusic","https://thevirus-limiter.github.io/shootout-in-space/sound/diamond-ace-triangles.mp3")
    loadSound ("bubbles","https://thevirus-limiter.github.io/shootout-in-space/sound/bubbles.wav")
    
    
    
    let score = 0;
    //setData("coins", coins)
    var coins = getData("coins")
    let levelNum = 0;
    let lives = 3;
    var BULLET_SPEED = 400;
    let diff = 1;
    var heartUpgrade = false;
    var coinsUpgrade = false;
    var oldCoins = coins
    var invincible = false;
    var invincibleTime = 0;
    var soundOn = true;
    var SFXsoundOn = true;
    var creditsOpen=false;
    var codesOpen=false;
    var loadTest = 1;
    var shopOpen=false;
    var skin = getData("skin");
    /*var oneOwned = false;
    var twoOwned = false;
    var threeOwned = false;
    var fourOwned = false;
    var heartOwned = false;
    var coinsOwned = false;*/
    var oneOwned = getData("oneOwned")
    var twoOwned = getData("twoOwned")
    var threeOwned = getData("threeOwned")
    var fourOwned = getData("fourOwned")
    var heartOwned = getData("heartOwned")
    var coinsOwned = getData("coinsOwned")
    var firstTime=false;
    var lengthNum=0;
    var code1 = "dev25"
    var code2 = "sus22"
    var code3 = "hi23"
    //var code2Used=false;
    //var code3Used=false;
    var code2Used=getData("code2Used")
    var code3Used=getData("code3Used")
    var tc = 0;		
	    var countDownNum=6
    //var invulnerable = false;
    //localStorage.setItem("test1",100)
    //debug.log(localStorage.getItem("test1"))

if(skin==null){
    skin=0;
}
if(code2Used==null){
    code2Used=false;
}
if(code3Used==null){
    code3Used=false;
}

if(oneOwned==null){
    oneOwned=false;
}
if(twoOwned==null){
    twoOwned=false;
}
if(threeOwned==null){
    threeOwned=false;
}
if(fourOwned==null){
    fourOwned=false;
}
if(heartOwned==null){
    heartOwned=false;
}
if(coinsOwned==null){
    coinsOwned=false;
}
    
    const directions = {
      LEFT: "left",
      RIGHT: "right"
    }
    let current_direction = directions.LEFT;
    
    //debug.log("coins: "+ coins+ " skin: "+skin)
    scene("oldVer",()=>{
        var gone = false;
    countDownNum = 6;
      layers([
      "bg",
      "text",
    ], "text");
  
    add([
      sprite("backg"),
      scale(2),
      layer("bg"),
      //color(0, 0, 139)
    ]);


    const infoText = add([
      text("Redirecting you to itch.io for the newest version of this game in: " + countDownNum + "\n\n(to avoid the redirect and play the older version, click anywhere)",{
          size:40,
          width:1000,
          font:"sinko",
      }),
      pos(center()),
      origin("center"),
      layer("text"),
  ])


    if(countDownNum>=0){
    loop(1,()=>{
        if(gone==false){
      countDownNum=countDownNum-1
      infoText.text="Redirecting you to itch.io for the newest version of this game in: " + countDownNum + "\n\n(to avoid the redirect and play the older version, click anywhere)"
    }})
  }
  onUpdate(()=>{
if(countDownNum==0){
    var gone = true;
    infoText.text=""
  window.location.href = "https://rehanraj.itch.io/shootout-in-space";
}

})
  onTouchStart(() => go("tts"))
  onClick(() => go("tts"))


  })
    scene("tts",()=>{
        layers([
        "bg",
        "text",
      ], "text");
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg"),
        //color(0, 0, 139)
      ]);


      const clickToStart=add([
        sprite("startImg"),
        pos(center()),
        origin("center"),
        "text"
      ])

    onClick(() => go("splash"))

    })




    
    scene("splash",()=>{
    
    
        layers([
        "bg",
        "splash",
      ], "splash");
    
      add([
        sprite("splashBG"),
        scale(20),
        layer("bg"),
        //color(0, 0, 139)
      ]);
    
    const splash = add([
        sprite("splash"),
        pos(center()),
        origin("center"),
    ])
    
    play("bubbles")
    
    
    wait(1.5,()=>{go("menu")})
      
    })
    
    
    scene("menu",()=>{
        lives=3;
        levelNum=0;
        score=0;
        diff=1;
        const menuMusic = play("menuMusic", {
        volume: 0.25,
        loop: true})
    
 
    
    
        onLoad(() => {
            menuMusic.play()
        });
    
    layers([
        "bg",
        "logo",
        "meteor",
        "play",
        "codesUI",
        "codesText",
        "ui",
      ], "ui");
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg")
      ]);
    
    
      function spawnMeteor() {
    
    const dir = choose([LEFT, RIGHT])
    
    add([
        sprite("meteor", { flipX: dir.eq(LEFT) }),
        move(dir, rand(20, 60)),
        cleanup(),
        pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
        origin("top"),
        area(),
        //z(-50),
        layer("meteor"),
        scale(rand(0.2,0.4)),
        "meteor"
    ])
    
    wait(rand(6, 12), spawnMeteor)
    }
    const logo= add([
    sprite("logo"),
    pos(949,-10),
    origin("top"),
    scale(1),
    layer("logo")
    ])
    const start= add([
    sprite("start"),
    pos(950,560),
    origin("center"),
    scale(0.55),
    layer("play"),
    //area(),
    area({ scale: 0.9 }),
    "start"
    //color(200, 20, 55)
    ])
    
    
    onKeyPress("c", ()=>{
        if(codesOpen==false){
        menuMusic.pause();
     go("credits")}
    })
    
    
    const startGray= add([
    sprite("graystart"),
    pos(950,560),
    origin("center"),
    scale(0.55),
    layer("play"),
    area(),
    //color(200, 20, 55)
    ])
    const shopBtn=add([
        sprite("shop"),
        pos(950,800),
        origin("center"),
        layer("play"),
        area({ width: 450, height: 200. }),
        scale(0.7),
        "shop"
    
    ])
    
    const settingsBtn=add([
        sprite("settings"),
        pos(80, 840),
        origin("center"),
        scale(0.5),
        area(),
        "settings"
    ])
    const creditsBtn=add([
        sprite("credits"),
        pos(250, 840),
        origin("center"),
        scale(0.48),
        area(),
        "credits"
    ])
    startGray.hidden = true;
    
    const settingsUI=add([
    sprite("settingsUI"),
    pos(center()),
    origin("center"),
    scale(1.2),
    ])
    
    const SFXOn=add([
        sprite("soundOn"),
        pos(1030,350),
        scale(0.2),
        area(),
        "SFXOn"
    ])
    
    const SFXOff=add([
        sprite("soundOff"),
        pos(1030,350),
        scale(0.2),
        area(),
        "SFXOff"
    ])
    
    SFXOn.hidden=true;
    SFXOff.hidden=true;
    
    const musicOn=add([
        sprite("soundOn"),
        pos(730,350),
        scale(0.2),
        area(),
        "musicOn"
    ])
    
    const musicOff=add([
        sprite("soundOff"),
        pos(730,350),
        scale(0.2),
        area(),
        "musicOff"
    ])
    
    musicOff.hidden =true;
    
    musicOn.hidden=true;
    
    settingsUI.hidden=true;
    
    var settingsOpen=false;
    
    onClick("settings", (settings) => {
        if(codesOpen==false){

    if(creditsOpen==false){
    if(settingsOpen==true){
    settingsUI.hidden=true;
    settingsOpen=false;
    musicOn.hidden=true;
    musicOff.hidden=true;
    SFXOn.hidden=true;
    SFXOff.hidden=true;
    }
    else{
    settingsOpen=true
    settingsUI.hidden=false
    if(SFXsoundOn==true){
    SFXOn.hidden=false;
    }
    else if(SFXsoundOn==false){
    SFXOff.hidden=false;
    }
    if(soundOn==true){
    musicOn.hidden=false;
    }
    else{
    musicOff.hidden=false;
    }}
    }}})
    
    onClick("musicOn", (musicOn) => {
        if(settingsOpen==true){
        if(soundOn==true){
        soundOn=false;
        musicOn.hidden=true;
        musicOff.hidden=false;
        //debug.log(soundOn)
        menuMusic.pause()
        }
        else{
            soundOn=true;
            musicOn.hidden=false;
            musicOff.hidden=true;
            //debug.log(soundOn)
    
            menuMusic.play()
        }
        }
    })
    
    onClick("SFXOn", (SFXOn) => {
    if(settingsOpen==true){
        if(SFXsoundOn==true){
        SFXsoundOn=false;
        SFXOn.hidden=true;
        SFXOff.hidden=false;
        //debug.log(SFXsoundOn)
        }
        else{
            SFXsoundOn=true;
            SFXOn.hidden=false;
            SFXOff.hidden=true;
            //debug.log(SFXsoundOn)
    
        }
    }
    })
    
    onClick("start", (start) => {
        if(codesOpen==false){
        menuMusic.pause()
        if(settingsOpen==false&&creditsOpen==false){
        go("loading")
        }}
    })
        onClick("credits", (credits) => {
            if(codesOpen==false){
        //menuMusic.pause()
        if(settingsOpen==false&&creditsOpen==false){
            menuMusic.pause();
            creditsOpen=true;
    
            
        go("credits")
    
        }}
    })
    
    loop(0.5,()=>{
        wait(0.5,()=>{
      if(creditsOpen==true){
        creditsOpen=false;
      }  })
    })
    

    onKeyPress("escape", () => {
    shake(1)
})
    
    onKeyPress("s", () => {
        if(codesOpen==false){
        if(settingsOpen==false&&creditsOpen==false){
            menuMusic.pause();
            shopOpen=true;
    
            
        go("shop")
    
        }}
    })
    onClick("shop", (shop) => {
        if(codesOpen==false){
        //menuMusic.pause()
        if(settingsOpen==false&&creditsOpen==false){
            menuMusic.pause();
            shopOpen=true;
    
            
        go("shop")
    
        }}
    })
    
    shopBtn.onUpdate(() => {
            if (shopBtn.isHovering()) {
                shopBtn.color = rgb(
                    128, 126, 121
                )
            } else {
                shopBtn.color = rgb()
            }
        })
    
    
        creditsBtn.onUpdate(() => {
            if (creditsBtn.isHovering()) {
                creditsBtn.color = rgb(
                    128, 126, 121
                )
            } else {
                creditsBtn.color = rgb()
            }
        })
    
    
        settingsBtn.onUpdate(() => {
            if (settingsBtn.isHovering()) {
                settingsBtn.color = rgb(
                    128, 126, 121
                )
            } else {
                settingsBtn.color = rgb()
            }
        })
    
    
    start.onUpdate(() => {
            if (start.isHovering()) {
                start.hidden=true;
                startGray.hidden=false;
            }
            else{
                start.hidden=false;
                startGray.hidden=true;
            }
        })
    
    
    spawnMeteor();
    
    if(soundOn==true){
    menuMusic.play()
    }
    else if(soundOn==false){
        menuMusic.pause()
    }
    
    const coinIcon= add([
            sprite("coin"),
            layer("ui"),
            scale("0.1"),
            pos(5,22)
            ])
    
                //coinsLabel.destroy()
            const coinsLabel = add([
        text(oldCoins,{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(64, 24),
        layer("ui"),
    ])
    if(coins==null){
    coins=0;
    oldCoins=0;
    coinsLabel.text=oldCoins;
}
    
    /*const coinsKLabel = add([
        text(Math.round(oldCoins/100) / 10+"k",{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(64, 24),
        layer("ui"),
    ])
    coinsKLabel.hidden=true;
    
    if(oldCoins>1000){
        coinsLabel.hidden=true;
        coinsKLabel.hidden=false;
    }
    
    if(oldCoins<1000){
        coinsLabel.hidden=false;
        coinsKLabel.hidden=true;
    }
    */
    if(skin==0){
    const miniPlayer = add([
        sprite("defSkin"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    
    
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    //setGravity()
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
        //setGravity()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    function setGravity(){
        gravity(50)
    }
    const testCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
        const testCoin2 = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
    
        miniPlayer.onCollide("tcoin", (tcoin) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    tcoin.destroy()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    }
    //music.play()
    })
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    else if(skin==1){
    const miniPlayer = add([
        sprite("skin2"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    //setGravity()
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
        //setGravity()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    function setGravity(){
        gravity(50)
    }
    const testCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
        const testCoin2 = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
    
        miniPlayer.onCollide("tcoin", (tcoin) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    tcoin.destroy()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    }
    //music.play()
    })
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    else if(skin==2){
    const miniPlayer = add([
        sprite("skin3"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    //setGravity()
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
        //setGravity()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    function setGravity(){
        gravity(50)
    }
    const testCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
        const testCoin2 = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
    
        miniPlayer.onCollide("tcoin", (tcoin) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    tcoin.destroy()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    }
    //music.play()
    })
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    else if(skin==3){
    const miniPlayer = add([
        sprite("skin4"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    //setGravity()
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
        //setGravity()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    function setGravity(){
        gravity(50)
    }
    const testCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
        const testCoin2 = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
    
        miniPlayer.onCollide("tcoin", (tcoin) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    tcoin.destroy()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    }
    //music.play()
    })
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    else if(skin==4){
    const miniPlayer = add([
        sprite("skin5"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    //setGravity()
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
        //setGravity()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    function setGravity(){
        gravity(50)
    }
    const testCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
        const testCoin2 = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(1594,rand(200,500)),
        layer("ui"),
        "tcoin"
        ])
    
    
        miniPlayer.onCollide("tcoin", (tcoin) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    tcoin.destroy()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    }
    //music.play()
    })
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    
    }
    

    const codesBtn=add([
        sprite("codesButton"),
        pos(1780, 830),
        origin("center"),
        scale(0.48),
        area(),
        "codes"
    ])

    const codesUI=add([
    sprite("codesUI"),
    pos(center()),
    origin("center"),
    scale(1.2),
    layer("codesUI")
    ])
    codesUI.hidden=true;

    codesBtn.onUpdate(() => {
            if (codesBtn.isHovering()) {
                codesBtn.color = rgb(
                    128, 126, 121
                )
            } else {
                codesBtn.color = rgb()
            }
        })
    
        onClick("codes", (codes) => {
    if(creditsOpen==false){
        if(codesOpen==true){
            codesOpen=false;
            codesUI.hidden=true;
            trueText.hidden=true;
            falseText.hidden=true;
            input.hidden=true;
        }
        else{
            firstTime=true;
        input.text="Type here!"
        codesOpen=true;
        codesUI.hidden=false;
        input.hidden=false;
    
    }
    }
   else{}
    })
    
    const trueText = add([
	pos(725,500),
	text("[The code worked!].green",{
		font:"sink",
		size: 35,
		lineSpacing: 8,
		letterSpacing: 4,
		styles: {
			"green": {
				color: rgb(0,160,0),
			},
		},
	})
])
const falseText = add([
	pos(690,500),
	text("[The code didn't work.].red",{
		font:"sink",
		size: 30,
		lineSpacing: 8,
		letterSpacing: 4,
		styles: {
			"red": {
				color: rgb(160,0,0),
			},
		},
	})
])
const wrongText = add([
	pos(690,500),
	text("[You've already used\n this code.].red",{
		font:"sink",
		size: 30,
		lineSpacing: 8,
		letterSpacing: 4,
		styles: {
			"red": {
				color: rgb(160,0,0),
			},
		},
	})
])
wrongText.hidden=true;
falseText.hidden=true;
trueText.hidden=true;
const input = add([
	pos(795,380),
    layer("codesText"),
	// Render text with the text() component
	firstTime=true,
	text("Type here!", {
        
		// What font to use
		font: "sink",
		// It'll wrap to next line if the text width exceeds the width option specified here
		//width: width() - pad * 2,
		// The height of character
		size: 40,
		lineSpacing: 8,
		letterSpacing: 4,
		// Transform each character for special effects
        transform: (idx, ch) => ({
        color: (255,255,255)
    }),
	}),
])
    
    
input.hidden=true;

onCharInput((ch) => {
    if(lengthNum<8){
	if(firstTime==true){
        lengthNum=1;
        input.text=""
        input.text=ch
		firstTime=false;
	}
	else{
        lengthNum=lengthNum+1
	input.text += ch}}
    else{shake(1)}
})

onKeyPressRepeat("backspace", () => {
    if(firstTime==true){
        lengthNum=1;
        input.text=""
        input.text=ch
		firstTime=false;
	}
	input.text = input.text.substring(0, input.text.length - 1)
    lengthNum=lengthNum-1;
})

onKeyPress("enter", () => {
	var answer=""
	answer=input.text;
	//input.text = ""
	codeCheck(answer)
})

function codeCheck(input){
	//debug.log(input)

if(input=="dev22"){
trueText.hidden=false;
oldCoins=oldCoins+15000;
setData("coins",oldCoins)
coinsLabel.text = oldCoins;
if(SFXsoundOn==true){
    play("coinPick")
}
//debug.log(coins)
wait(3,()=>{
	trueText.hidden=true;
})
}

else if(input=="sus22"){
    //debug.log(code2Used)
	if(code2Used==false){
code2Used=true;
setData("code2Used",true)
	trueText.hidden=false;
oldCoins=oldCoins+500
setData("coins",oldCoins)
coinsLabel.text = oldCoins;
if(SFXsoundOn==true){
    play("coinPick")
}
//debug.log(coins)
wait(3,()=>{
	trueText.hidden=true;
})

}
else{shake(1) 
trueText.hidden=true;
falseText.hidden=true
wrongText.hidden=false;
wait(3,()=>{
	wrongText.hidden=true;
})
}
}

else if(input=="hi23"){
	if(code3Used==false){
code3Used=true;
setData("code3Used",true)
	trueText.hidden=false;
oldCoins=oldCoins+150
setData("coins",oldCoins)
coinsLabel.text = oldCoins;
if(SFXsoundOn==true){
    play("coinPick")
}
//debug.log(coins)
wait(3,()=>{
	trueText.hidden=true;
})

}
else{shake(1) 
    trueText.hidden=true;
falseText.hidden=true
wrongText.hidden=false;
wait(3,()=>{
	wrongText.hidden=true;
})
}
}

else{
	trueText.hidden=true;
falseText.hidden=false;
wait(3,()=>{
	falseText.hidden=true;})
}

	
}


    })
    

    
    
    
    scene("loading",()=>{
    var protipLuck=randi(0,3)
        layers([
        "bg",
        "loading",
      ], "loading");
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg"),
        //color(0, 0, 139)
      ]);
    
    if(protipLuck==0||protipLuck==1){
      const loading = add([
        sprite("loading"),
        pos(center()),
        origin("center"),
    ])
    
    wait(0.2,()=>{go("game")})
}

else if(protipLuck==2){
      const proTip = add([
        sprite("protip"),
        pos(center()),
        origin("center"),
        scale(0.6)
    ])
    
    wait(1.5,()=>{go("game")})
}
    })
    
    scene("game", () => {
    
    coins=0;
    const music = play("music", {
        volume: 0.25,
        loop: true
    })
     
    
    loop(1,()=>{
    if(soundOn==true){
        music.play()
    
    }
    if (soundOn==false){
    music.pause()
    }})
    
    
    if(skin==0){
         const level = addLevel([
        // Design the level layout with symbols
        "        ",
        "      1 ",
        "        ",
        "  @   2 ",
        "        ",
        "      3 ",
        "        ",
        "        ",
        "======= ",
    ], {
        // The size of each grid
        width: 280,
        height: 110,
        // The position of the top left block
        pos: vec2(100, 200),
        // Define what each symbol means (in components)
        
        "@": () => [
            sprite("defSkin"),
            area(),
            body(),
            origin("bot"),
            layer("game"),
            scale(0.15),
            "player",
        ],
        "=": () => [
            sprite("grass1"),
            scale(1.3),
            area(),
            solid(),
            origin("bot"),
            "ground"
        ],
        "1": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo1",
        ],
        "2": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo2",
        ],
        "3": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo3",
        ],
    })
    }
    
    
    else if(skin==1){
         const level = addLevel([
        // Design the level layout with symbols
        "        ",
        "      1 ",
        "        ",
        "  @   2 ",
        "        ",
        "      3 ",
        "        ",
        "        ",
        "======= ",
    ], {
        // The size of each grid
        width: 280,
        height: 110,
        // The position of the top left block
        pos: vec2(100, 200),
        // Define what each symbol means (in components)
        
        "@": () => [
            sprite("skin2"),
            area(),
            body(),
            origin("bot"),
            layer("game"),
            scale(0.15),
            "player",
        ],
        "=": () => [
            sprite("grass1"),
            scale(1.3),
            area(),
            solid(),
            origin("bot"),
            "ground"
        ],
        "1": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo1",
        ],
        "2": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo2",
        ],
        "3": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo3",
        ],
    })
    }
    
    
    else if(skin==2){
         const level = addLevel([
        // Design the level layout with symbols
        "        ",
        "      1 ",
        "        ",
        "  @   2 ",
        "        ",
        "      3 ",
        "        ",
        "        ",
        "======= ",
    ], {
        // The size of each grid
        width: 280,
        height: 110,
        // The position of the top left block
        pos: vec2(100, 200),
        // Define what each symbol means (in components)
        
        "@": () => [
            sprite("skin3"),
            area(),
            body(),
            origin("bot"),
            layer("game"),
            scale(0.15),
            "player",
        ],
        "=": () => [
            sprite("grass1"),
            scale(1.3),
            area(),
            solid(),
            origin("bot"),
            "ground"
        ],
        "1": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo1",
        ],
        "2": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo2",
        ],
        "3": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo3",
        ],
    })
    }
    
    else if(skin==3){
         const level = addLevel([
        // Design the level layout with symbols
        "        ",
        "      1 ",
        "        ",
        "  @   2 ",
        "        ",
        "      3 ",
        "        ",
        "        ",
        "======= ",
    ], {
        // The size of each grid
        width: 280,
        height: 110,
        // The position of the top left block
        pos: vec2(100, 200),
        // Define what each symbol means (in components)
        
        "@": () => [
            sprite("skin4"),
            area(),
            body(),
            origin("bot"),
            layer("game"),
            scale(0.15),
            "player",
        ],
        "=": () => [
            sprite("grass1"),
            scale(1.3),
            area(),
            solid(),
            origin("bot"),
            "ground"
        ],
        "1": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo1",
        ],
        "2": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo2",
        ],
        "3": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo3",
        ],
    })
    }
    
    
    else if(skin==4){
         const level = addLevel([
        // Design the level layout with symbols
        "        ",
        "      1 ",
        "        ",
        "  @   2 ",
        "        ",
        "      3 ",
        "        ",
        "        ",
        "======= ",
    ], {
        // The size of each grid
        width: 280,
        height: 110,
        // The position of the top left block
        pos: vec2(100, 200),
        // Define what each symbol means (in components)
        
        "@": () => [
            sprite("skin5"),
            area(),
            body(),
            origin("bot"),
            layer("game"),
            scale(0.15),
            "player",
        ],
        "=": () => [
            sprite("grass1"),
            scale(1.3),
            area(),
            solid(),
            origin("bot"),
            "ground"
        ],
        "1": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo1",
        ],
        "2": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo2",
        ],
        "3": () => [
            sprite("ufo"),
            scale(0.3),
            area(),
            solid(),
            origin("bot"),
            "ufo3",
        ],
    })
    }
    
    
    
    
    
    
    const player = get("player")[0]
    const ufo1 = get("ufo1")[2]
    const ufo2 = get("ufo2")[3]
    const ufo3 = get("ufo3")[4]
    
    
    
    
        layers([
        "bg",
        "respawnPlatform",
        "meteor",
        "game",
        "ui",
      ], "game");
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg")
      ]);
    
    
      function spawnMeteor() {
    
    const dir = choose([LEFT, RIGHT])
    
    add([
        sprite("meteor", { flipX: dir.eq(LEFT) }),
        move(dir, rand(20, 60)),
        cleanup(),
        pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
        origin("top"),
        area(),
        //z(-50),
        layer("meteor"),
        scale(rand(0.2,0.4))
    ])
    
    wait(rand(8, 18), spawnMeteor)
    
    }
    
    
    spawnMeteor();
    
    
      if(heartUpgrade==true){
        lives=4
    }
    
    
    if(heartUpgrade==true){
        const heartIcon = add([
        sprite("blueheart"),
        pos(-5,130),
        scale(0.26),
        layer("ui")
    ])
        }
    
    else if(heartUpgrade==false){
    const heartIcon = add([
        sprite("heart"),
        pos(-5,130),
        scale(0.26),
        layer("ui")
    ])
    }
    
    
    const heartText= add([
    text(lives,{
        size:80,
            width:300,
            font:"sinko",
    }),
    layer("ui"),
    pos(120,160)
    
    ])
    
    
    const invText=add([
    text(invincibleTime,{
        size:50,
        width:300,
        font:"sinko"
    }),
    layer("ui"),
    pos(70,825)
    
    
    ])
    
    const invIcon = add([
        sprite("shield"),
        layer("ui"),
        pos(10, 820),
        scale(0.1)
    ])
    invText.hidden = true;
    invIcon.hidden=true;
    
    const levelText=add([
    text(levelNum,{
        size:60,
        width:300,
        font:"sinko"
    }),
    layer("ui"),
    pos(950,22)
    
    
    ])
    
    
    const scoreIcon = add([
        sprite("timer"),
        layer("ui"),
        pos(5, 80),
        scale(0.1)
    ])
    
            const scoreLabel = add([
        text(score,{
            size:50,
            width:300,
            font:"sinko",
        }),
        layer("ui"),
        pos(64, 80)
    ])
    
    
    loop(2, () => {
                score++;
                scoreLabel.text = score;
    
            });
    
        const coinIcon= add([
            sprite("coin"),
            layer("ui"),
            scale("0.1"),
            pos(5,22)
            ])
    
                //coinsLabel.destroy()
            const coinsLabel = add([
        text(coins,{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(64, 24),
        layer("ui"),
    ])
      
    
    function levelUpdate(){
        levelNum = Math.floor(score/5);
        levelText.text = levelNum;
        if(levelNum<=15){
        BULLET_SPEED = levelNum*100+200
    }
        else if(levelNum>15){
            BULLET_SPEED = 15*100+200
        }
        if(diff>0.4){
        diff = diff- levelNum/10
    }
    
    }
    
    loop(2, () => {
                levelUpdate()
    
            });
    
    
    const shooter1 = add([
        sprite("ufo"),
        pos(1780,230),
        scale(0.3),
        origin("center"),
        area(),
        layer("game")
    ])
    
    const shooter2 = add([
        sprite("ufo"),
        pos(1780,450),
        scale(0.3),
        origin("center"),
        area(),
        layer("game")
    ])
    
    const shooter3 = add([
        sprite("ufo"),
        pos(1780,670),
        scale(0.3),
        origin("center"),
        area(),
        layer("game")
    ])
    
      const border = add([
      
        rect(width(), 48),
        pos(0, height() - 950),
        //outline(4),
        area(),
            solid(),
        color(6, 18, 33	),
         "roof"
    
    
      ])
    
    
    
      
      
    
      mouseClick(() => {
                //debug.log("click")
                if(!player.invulnerable==true){
               player.jump(700);
            }
             });
    
    onKeyPress("space", () => {
        if(!player.invulnerable==true){
        player.jump(700);
        }
    });
    
    //easter egg!!
    
    loop(3,()=>{
    if(levelNum==69){
        const t = time() * 10
                player.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    
                shooter1.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
                
    
            shooter2.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    
                shooter3.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    
    }
    else{player.color=rgb()
    shooter1.color=rgb()
    shooter2.color=rgb()
    shooter3.color=rgb()
    }
    })
    
    
    function shoot(){
    
        var getShip = randi(0,3)
        //console.log(getShip)
        //debug.log(ufo1.pos)
        var ship1 = (1780,310)
        var ship2 = (1780,530)
        var ship3 = (1780,750)
    
    //spawnBullet(shooter1.pos)
     if(getShip==0){
        if(levelNum>10){
        spawnBullet(shooter1.pos);
        shootSound()
        spawnBullet(shooter1.pos);
        shootSound()
    }
    else if(levelNum<=10){spawnBullet(shooter1.pos);
        shootSound()}
        }


        else if(getShip==1){
            if(levelNum>10){
        spawnBullet(shooter2.pos);
        shootSound()
        spawnBullet(shooter2.pos);
        shootSound()
    }
    else if(levelNum<=10){spawnBullet(shooter2.pos);
        shootSound()}
        }


        else if(getShip==2){
            if(levelNum>10){
        spawnBullet(shooter3.pos);
        shootSound()
        spawnBullet(shooter3.pos);
        shootSound()
    }
    else if(levelNum<=10){spawnBullet(shooter3.pos);
        shootSound()}
    }
    
    
    
    }
    
    
    function shootSound(){
        var getSound = randi(0,2)
        if(getSound==0){
        //music.pause()
        if(SFXsoundOn==true){
        play("shoot",{
            volume: 0.15,
        })
    }
        //music.play()
    }
    
    else if(getSound==1){
        //music.pause()
        if(SFXsoundOn==true){
        play("shoot1",{
            volume: 0.15,
        })}
        //music.play()
    }
    }
    
    shoot();
    
    loop(diff, () => {
    shoot();
    cleanup();
    });
    
    
    onUpdate(() => {
    cleanup()
    })
    
    
    
    function spawnBullet(bulletpos) {
        if (current_direction == directions.LEFT){
            bulletpos = bulletpos.sub(10,0);
        } else if (current_direction == directions.RIGHT){
            bulletpos = bulletpos.add(10,0);
        }
        add([
            rect(30, 5),
            pos(bulletpos),
            origin("center"),
            color(255, 0, 0),
            area(),
            move(LEFT, BULLET_SPEED),
            layer("game"),
            "bullet",
            "danger"
            
        ]);
    
        }
    
    // isnt working
    /*function spawnCoin(){
        const playCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(635, rand(800, 200)),
        "reward"
        ])
    }
    */
    
    loop(rand(0.5,1), () => {
       // var coinLuck = 2
        var coinLuck = randi(0,8)
    //console.log(coinLuck);
    if(coinLuck==0){
        const playCoin = add([
        sprite("coin"),
        scale(0.1),
        area(),
        pos(635, rand(200, 800)),
        "coin"
        ])
    }
    
    
    
    else{
        cleanup();
    }
    });
    
    loop(rand(2,3.5), () => {
        var heartLuck = randi(0,15)
    if(heartLuck==0){
        const heartPowerUp= add([
            sprite("heart"),
            scale("0.15"),
            pos(625, rand(200, 800)),
            area(),
            "powerup",
            "heartpowerup"
        ])
    
    }
    })
    
    loop(rand(2,3.5), () => {
        //var shieldLuck = 0;
        var shieldLuck = randi(0,11)
    if(shieldLuck==0){
        const shield= add([
            sprite("shield"),
            scale("0.13"),
            pos(625, rand(200, 800)),
            area(),
            "powerup",
            "shieldpowerup"
        ])
    
    }
    })
    
    //const playCoins = get("hi")
    //var coins1 = 0;
    
    
    player.onCollide("coin", (coin) =>{
    if(!player.invulnerable){
    //music.pause()
    //debug.log("ouch")
    coin.destroy()
    if(coinsUpgrade==true){
        coins=coins+10;
        setData("coins",coins)

    }
    else if(coinsUpgrade==false){
    coins=coins+5;
    //debug.log(coins)
    //coins = setData("coins", coins)

    }
    //debug.log(coins)
    coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    //music.play()
    }
    })
    player.onCollide("heartpowerup", (heart) =>{
    if(!player.invulnerable){
    //music.pause()
    //debug.log("ouch")
    heart.destroy()
    lives=lives+1;
    //debug.log(coins)
    heartText.text = lives;
    if(SFXsoundOn==true){
    play("coinPick");
    }
    //music.play()
    }
    })
    player.onCollide("shieldpowerup", (shield) =>{
        invincibleTime=4+skin;
        invIcon.hidden=false;
        invText.hidden=false;
        //var powerUpTime=3;
    if(!player.invulnerable){
    //music.pause()
    //debug.log("ouch")
    shield.destroy()
    //lives=lives+1;
    //debug.log(coins)
    invincible=true;
    //heartText.text = lives;
    play("coinPick");
    invLogic()
    //music.play()
    
    /*loop(1.5,()=>{
        if(invincibleTime<0||invincibleTime==0){
        invIcon.hidden = true;
        invText.hidden = true;
        invincible=false;
    }
    else{
        invincibleTime=invincibleTime-1;
        invText.text = invincibleTime;
    }
    })*/
    
    
    
    }
    
    })
    
    function invLogic(){
        var secondsNum=3+skin;
        invincibleTime=3+skin;
    invText.text=invincibleTime
   if(secondsNum==3){
    wait(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=2;
                invText.text = invincibleTime;
    
            });
            wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });
        }
        else if(secondsNum==4){
    wait(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=3;
                invText.text = invincibleTime;
    
            });
            wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=2;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(4, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });
        }
        else if(secondsNum==5){
    wait(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=4;
                invText.text = invincibleTime;
    
            });
            wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=3;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=2;
                invText.text = invincibleTime;
    
            });
            wait(4, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(5, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });
        }
        else if(secondsNum==6){
    wait(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=5;
                invText.text = invincibleTime;
    
            });
            wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=4;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=3;
                invText.text = invincibleTime;
    
            });
            wait(4, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=2;
                invText.text = invincibleTime;
    
            });
            wait(5, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(6, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });
        }

        else if(secondsNum==7){
    wait(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=6;
                invText.text = invincibleTime;
    
            });
            wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=5;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=4;
                invText.text = invincibleTime;
    
            });
            wait(4, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=3;
                invText.text = invincibleTime;
    
            });
            wait(5, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=2;
                invText.text = invincibleTime;
    
            });
            wait(6, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(7, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });
        }

    }
       /* wait(2, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=1;
                invText.text = invincibleTime;
    
            });
            wait(3, () => {
            if(invincibleTime<0||invincibleTime==0){
                invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
            }
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
    
            });*/
    
    
    
    /*loop(0.5,()=>{
        if(invincibleTime<0||invincibleTime==0){
        invIcon.hidden = true;
        invText.hidden = true;
        invincible=false;
    }
    else{
        cleanup()
    }
    })*/

    

/* loop(1, () => {
            if(invincibleTime<0||invincibleTime==0){
                invincibleTime=0;
                invText.text = invincibleTime;
                wait(0.5,()=>{
                    invIcon.hidden=true;
                invText.hidden=true;
                invincible=false;
                })
            }
                
    else{
                invincibleTime=invincibleTime-1;
                invText.text = invincibleTime;

    }
            });
    
            }*/


    
    function ufoSpawn(ufoPosX, ufoPosY){
       // music.pause()
       if(SFXsoundOn==true){
        play("comet",{    volume: 0.15,
    })}
        const comet = add([
        sprite("comet"),
        scale(0.2),
        area(),
        pos(ufoPosX, ufoPosY),
        move(LEFT,BULLET_SPEED),
        layer("game"),
        "danger"
        ])
        //music.play()
    }


    loop(rand(2,2.5), () => {
        //var cometNum = randi(0,4)
    var cometNum = randi(0,6)
    //debug.log(cometNum)
    
    if(cometNum==0){
    ufoSpawn(1850,800)
    }
    
    else if(cometNum==1||cometNum==2){
    ufoSpawn(1850, 50)
    }
    
    else{
    
    }
    
    });
    
    //coinsLabel.destroy()
            
    onCollide("player", "danger", (p, d) => {
            if(player.invulnerable==false){
            d.destroy()
        }
        else{}
            p.trigger("damage");
    });
    
    /*onCollide("player","roof",(player,roof)=>{
    player.pos.y= 970
    
    })*/
    
    onCollide("player","ground",(p,ground) =>{
       // wait(3, ()=>{
    
        /*if(player.invulnerable){
            const spawnBase=add([
            sprite("grass1"),
            scale(1.3,1.3),
            area(),
            pos(660,970),
            origin("bot"),
            solid(),
            lifespan(8)
            ])
            
    }
    else{*/
        player.pos.y=65
    //}
        })
    
     
    
    //})
    
    player.on("damage", () => {
        if (!player.invulnerable &&invincible==false) { // new if statement
            lives = lives-1
            heartText.text = lives;
            shake()
            const spawnBase=add([
            sprite("grass1"),
            scale(1.3,1.3),
            area(),
            pos(660,970),
            origin("bot"),
            solid(),
            lifespan(7),
            layer("respawnPlatform")
            ])
            player.pos.y=880
            
        }
    
        // destroy ship if lives finished
        if (lives<=0) {
            setData("coins",oldCoins+coins)
            go("gameover")
            music.pause()
        }
        else // new code
        {
            if(invincible==false){
            // Temporary invulnerability
            player.invulnerable = true;
            player.hidden = true;
    
        
        var skinHalf = skin/2
            wait(2+skinHalf, () => {
                player.invulnerable = false;
                player.hidden = false;
            });
            }  
        }
    
    });
    
    onKeyPress("escape", () => {
        setData("coins",oldCoins+coins)
        shake(1)
    go("gamequit")
})
    
    
    
    
        });
    
        scene("gameover", () => {
    
            if(SFXsoundOn==true){
            play("lose")}
    
            layers([
        "bg",
        "meteor",
        "ui",
      ], "ui");
    
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg")
      ]);
     
    
      function spawnMeteor() {
    
    const dir = choose([LEFT, RIGHT])
    
    add([
        sprite("meteor", { flipX: dir.eq(LEFT) }),
        move(dir, rand(20, 60)),
        cleanup(),
        pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
        origin("top"),
        area(),
        //z(-50),
        layer("meteor"),
        scale(rand(0.2,0.4)),
        "meteor"
    ])
    
    wait(rand(8, 18), spawnMeteor)
    
    }
    
    
    spawnMeteor();
    
    
    
        const endText = add([
        text("Game Over",{
            size:80,
            width:3000,
            font:"sinko",
        }),
        pos(950,200),
            origin("center"),
        ])
    
        const levelEnd = add([
        text("Level " + levelNum,{
            size:50,
            width:3000,
            font:"sinko",
        }),
            pos(920,350),
            origin("center"),
        ])
    
    
        const scoreIcon = add([
        sprite("timer"),
        pos(1150, 505),
        scale(0.1)
    ])
    
            const scoreLabel = add([
        text(score,{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(1210, 505)
    ])
    
    
    const restartLabel = add([
        text("Press R to go to the menu",{
            size:50,
            width:3000,
            font:"sinko",
        }),
        pos(450,700)
    ])
    
        const coinIcon= add([
            sprite("coin"),
            scale("0.1"),
            pos(600,500)
            ])
            const coinsLabel = add([
        text(coins,{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(660, 505)
    ])
    
    
    if(skin==0){
    const miniPlayer = add([
        sprite("defSkin"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    miniPlayer.hidden=true;
    gravity(50)
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    
       
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    if(skin==1){
    const miniPlayer = add([
        sprite("skin2"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    miniPlayer.hidden=true;
    gravity(50)
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    
       
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    if(skin==2){
    const miniPlayer = add([
        sprite("skin3"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    
    miniPlayer.hidden=true;
    gravity(50)
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    
       
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    if(skin==3){
    const miniPlayer = add([
        sprite("skin4"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    miniPlayer.hidden=true;
    gravity(50)
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    
       
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    if(skin==4){
    const miniPlayer = add([
        sprite("skin5"),
        pos(mousePos()),
        scale(0.2),
        area(),
        body(),
        layer("meteor")
    ])
    miniPlayer.hidden=true;
    gravity(50)
    onMouseDown("left",()=>{
        miniPlayer.hidden=false;
        miniPlayer.pos = mousePos()
    })
    /*!onMouseDown("left",()=>{
        const t = time() * 10
                miniPlayer.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    })*/
    
    
       
    
    miniPlayer.onCollide("meteor", (meteor) =>{
    if(miniPlayer.hidden==false){
    //music.pause()
    //debug.log("ouch")
    meteor.destroy()
    shake()
    //coins=coins+1;
    //debug.log(coins)
    //coinsLabel.text = coins;
    if(SFXsoundOn==true){
    play("shoot");
    }
    }
    //music.play()
    })
    }
    
    
    
    
    
    onKeyPress("r", () => {
        oldCoins=oldCoins+coins;
        /*levelNum=0;
        score=0;
        diff=0;
        if(heartUpgrade==true){
            lives=4;
        }
        else{
            lives=3;
        }
        go("game")
        });*/
        go("menu")
    });
    wait(30, () => {
        oldCoins=oldCoins+coins
        go("menu") 
    })
        });


        scene("gamequit", () => {
    
    if(SFXsoundOn==true){
    play("lose")}

    layers([
"bg",
"meteor",
"ui",
], "ui");


add([
sprite("backg"),
scale(2),
layer("bg")
]);


function spawnMeteor() {

const dir = choose([LEFT, RIGHT])

add([
sprite("meteor", { flipX: dir.eq(LEFT) }),
move(dir, rand(20, 60)),
cleanup(),
pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
origin("top"),
area(),
//z(-50),
layer("meteor"),
scale(rand(0.2,0.4)),
"meteor"
])

wait(rand(8, 18), spawnMeteor)

}


spawnMeteor();



const endText = add([
text("You Quit",{
    size:80,
    width:3000,
    font:"sinko",
}),
pos(950,200),
    origin("center"),
])

const levelEnd = add([
text("Level " + levelNum,{
    size:50,
    width:3000,
    font:"sinko",
}),
    pos(920,350),
    origin("center"),
])


const scoreIcon = add([
sprite("timer"),
pos(1150, 505),
scale(0.1)
])

    const scoreLabel = add([
text(score,{
    size:50,
    width:300,
    font:"sinko",
}),
pos(1210, 505)
])


const restartLabel = add([
text("Press R to go to the menu",{
    size:50,
    width:3000,
    font:"sinko",
}),
pos(450,700)
])

const coinIcon= add([
    sprite("coin"),
    scale("0.1"),
    pos(600,500)
    ])
    const coinsLabel = add([
text(coins,{
    size:50,
    width:300,
    font:"sinko",
}),
pos(660, 505)
])


if(skin==0){
const miniPlayer = add([
sprite("defSkin"),
pos(mousePos()),
scale(0.2),
area(),
body(),
layer("meteor")
])
miniPlayer.hidden=true;
gravity(50)
onMouseDown("left",()=>{
miniPlayer.hidden=false;
miniPlayer.pos = mousePos()
})
/*!onMouseDown("left",()=>{
const t = time() * 10
        miniPlayer.color = rgb(
            wave(0, 255, t),
            wave(0, 255, t + 2),
            wave(0, 255, t + 4),
        )
})*/




miniPlayer.onCollide("meteor", (meteor) =>{
if(miniPlayer.hidden==false){
//music.pause()
//debug.log("ouch")
meteor.destroy()
shake()
//coins=coins+1;
//debug.log(coins)
//coinsLabel.text = coins;
if(SFXsoundOn==true){
play("shoot");
}
}
//music.play()
})
}
if(skin==1){
const miniPlayer = add([
sprite("skin2"),
pos(mousePos()),
scale(0.2),
area(),
body(),
layer("meteor")
])
miniPlayer.hidden=true;
gravity(50)
onMouseDown("left",()=>{
miniPlayer.hidden=false;
miniPlayer.pos = mousePos()
})
/*!onMouseDown("left",()=>{
const t = time() * 10
        miniPlayer.color = rgb(
            wave(0, 255, t),
            wave(0, 255, t + 2),
            wave(0, 255, t + 4),
        )
})*/




miniPlayer.onCollide("meteor", (meteor) =>{
if(miniPlayer.hidden==false){
//music.pause()
//debug.log("ouch")
meteor.destroy()
shake()
//coins=coins+1;
//debug.log(coins)
//coinsLabel.text = coins;
if(SFXsoundOn==true){
play("shoot");
}
}
//music.play()
})
}
if(skin==2){
const miniPlayer = add([
sprite("skin3"),
pos(mousePos()),
scale(0.2),
area(),
body(),
layer("meteor")
])

miniPlayer.hidden=true;
gravity(50)
onMouseDown("left",()=>{
miniPlayer.hidden=false;
miniPlayer.pos = mousePos()
})
/*!onMouseDown("left",()=>{
const t = time() * 10
        miniPlayer.color = rgb(
            wave(0, 255, t),
            wave(0, 255, t + 2),
            wave(0, 255, t + 4),
        )
})*/




miniPlayer.onCollide("meteor", (meteor) =>{
if(miniPlayer.hidden==false){
//music.pause()
//debug.log("ouch")
meteor.destroy()
shake()
//coins=coins+1;
//debug.log(coins)
//coinsLabel.text = coins;
if(SFXsoundOn==true){
play("shoot");
}
}
//music.play()
})
}
if(skin==3){
const miniPlayer = add([
sprite("skin4"),
pos(mousePos()),
scale(0.2),
area(),
body(),
layer("meteor")
])
miniPlayer.hidden=true;
gravity(50)
onMouseDown("left",()=>{
miniPlayer.hidden=false;
miniPlayer.pos = mousePos()
})
/*!onMouseDown("left",()=>{
const t = time() * 10
        miniPlayer.color = rgb(
            wave(0, 255, t),
            wave(0, 255, t + 2),
            wave(0, 255, t + 4),
        )
})*/




miniPlayer.onCollide("meteor", (meteor) =>{
if(miniPlayer.hidden==false){
//music.pause()
//debug.log("ouch")
meteor.destroy()
shake()
//coins=coins+1;
//debug.log(coins)
//coinsLabel.text = coins;
if(SFXsoundOn==true){
play("shoot");
}
}
//music.play()
})
}
if(skin==4){
const miniPlayer = add([
sprite("skin5"),
pos(mousePos()),
scale(0.2),
area(),
body(),
layer("meteor")
])
miniPlayer.hidden=true;
gravity(50)
onMouseDown("left",()=>{
miniPlayer.hidden=false;
miniPlayer.pos = mousePos()
})
/*!onMouseDown("left",()=>{
const t = time() * 10
        miniPlayer.color = rgb(
            wave(0, 255, t),
            wave(0, 255, t + 2),
            wave(0, 255, t + 4),
        )
})*/




miniPlayer.onCollide("meteor", (meteor) =>{
if(miniPlayer.hidden==false){
//music.pause()
//debug.log("ouch")
meteor.destroy()
shake()
//coins=coins+1;
//debug.log(coins)
//coinsLabel.text = coins;
if(SFXsoundOn==true){
play("shoot");
}
}
//music.play()
})
}





onKeyPress("r", () => {
oldCoins=oldCoins+coins;
/*levelNum=0;
score=0;
diff=0;
if(heartUpgrade==true){
    lives=4;
}
else{
    lives=3;
}
go("game")
});*/
go("menu")
});
wait(30, () => {
oldCoins=oldCoins+coins
go("menu") 
})
});

    
        scene("credits", () => {
            layers([
        "bg",
        "meteor",
        "text",
      ], "text");
    
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg")
      ]);
     
    
      function spawnMeteor() {
    
    const dir = choose([LEFT, RIGHT])
    
    add([
        sprite("meteor", { flipX: dir.eq(LEFT) }),
        move(dir, rand(20, 60)),
        cleanup(),
        pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
        origin("top"),
        area(),
        //z(-50),
        layer("meteor"),
        scale(rand(0.2,0.4))
    ])
    
    wait(rand(8, 18), spawnMeteor)
    
    }
    
    
    //spawnMeteor();
    
    const creditsText=add([
        pos(center()),
        origin("center"),
        layer("text"),
        text("Images: \nUfo icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/ufo\nSpace background by drakzlin - https://opengameart.org/content/space-background-7\nMoney icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/money\nClock icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/clock\nHeart icons created by frelayasia (Flaticon) - https://www.flaticon.com/free-icons/heart\nMute icons created by Roundicons (Flaticon) - https://www.flaticon.com/free-icons/mute\nSpeaker icons created by Roundicons (Flaticon) - https://www.flaticon.com/free-icons/speaker\nMeteor icons created by Smashicons (Flaticon) - https://www.flaticon.com/free-icons/meteor\nPixel icons created by Taufik Ramadhan (Flaticon) - https://www.flaticon.com/free-icons/pixel\nUfo icons created by Freepik - (Flaticon) - https://www.flaticon.com/free-icons/ufo\nSpaceship icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/spaceship\nMeteor icons created by Smashicons (Flaticon) - https://www.flaticon.com/free-icons/meteor\nSpaceship icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/spaceship\nSpaceship icons created by Freepik (Flaticon) - https://www.flaticon.com/free-icons/spaceship\nSpaceship icons created by photo3idea_studio (Flaticon) - https://www.flaticon.com/free-icons/spaceship\n\nSound effects:\nBLASTER 2 created by tutarap (Pixabay) - https://pixabay.com/sound-effects/id-81267/\nLaser gun Sound effects from https://www.free-stock-music.com\nCollectCoin created by bradwesson (Pixabay) - https://pixabay.com/sound-effects/id-6075/\nRetro arcade game over sound effect - https://mixkit.co/free-sound-effects/lose/\nFire Breath created by bspiller5 (Pixabay) - https://pixabay.com/sound-effects/id-6922/\n\nMusic:\nHELIOS BEAM by B E T T O G H | https://soundcloud.com/bettogh\nMusic promoted by https://www.free-stock-music.com\nCreative Commons Attribution-ShareAlike 3.0 Unported\nhttps://creativecommons.org/licenses/by-sa/3.0/deed.en_US\n\nTriangles by Diamond Ace | https://soundcloud.com/diamond-ace-music\nMusic promoted by https://www.free-stock-music.com\nCreative Commons Attribution-ShareAlike 3.0 Unported\nhttps://creativecommons.org/licenses/by-sa/3.0/deed.en_US\n\nGame by Rehan Raj using Kaboom.JS",{
            size:23,
            width:2000,
            font:"sinko"
        }
        
        )
    ])
    
    const infoText=add([
        pos(10,655),
        layer("text"),
        text("Click anywhere to go \nback",{
        size:40,
        width:350,
        font:"sinko"
    },
    
    )
    
    
    ])
    loop(0.5,()=>{
        const t = time() * 10
                infoText.color = rgb(
                    wave(0, 255, t),
                    wave(0, 255, t + 2),
                    wave(0, 255, t + 4),
                )
    
        
    });
    onClick(() => {
    
    go("menu")
    
    })
    
    
    
    
        });
    
        scene("shop", () => {
    
            const music = play("music", {
        volume: 0.25,
        loop: true
    })
     
    if(soundOn==true){
        music.play()
    
    }
    else if(soundOn==false){
    music.pause()
    }
            layers([
        "bg",
        "meteor",
        "ui",
        "buttons"
      ], "ui");
    
    
      add([
        sprite("backg"),
        scale(2),
        layer("bg")
      ]);
     
    
      function spawnMeteor() {
    
    const dir = choose([LEFT, RIGHT])
    
    add([
        sprite("meteor", { flipX: dir.eq(LEFT) }),
        move(dir, rand(20, 60)),
        cleanup(),
        pos(dir.eq(LEFT) ? width() : 0, rand(-20, 800)),
        origin("top"),
        area(),
        //z(-50),
        layer("meteor"),
        //lifespan(10),
        scale(rand(0.3,0.5)),
        "meteor"
    ])
    
    wait(rand(15, 30), spawnMeteor)
    
    
    
    }
    
    
    spawnMeteor();
    
    
    
    /*onClick("meteor", (meteor)=>{
    meteor.destroy()
    shake()
    if(SFXsoundOn=true){
    play("shoot")
    }
    })*/
    
var chromebook = false;

    if(chromebook==true){
    const shopUI = add([
        sprite("shopUI"),
        pos(center()),
        origin("center"),
        scale(0.8),
        area(),
        layer("ui"),
        "shop"
    ])
      //debug.log(shopUI.pos)
    }
else if(chromebook==false){
   const shopUI = add([
        sprite("shopUI"),
        pos(center()),
        origin("center"),
        scale(0.8),
        //area(),
        layer("ui"),
        "shop"
    ])
}
    const defBuy = add([
        sprite("defbuy"),
        pos(402.5,435),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
    ])
    
    const defEquipped = add([
        sprite("equipped"),
        pos(402.5,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons"
    ])
    
    const defEquip = add([
        sprite("equip"),
        pos(402.5,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "defEquip"
    ])
    
    const oneBuy = add([
        sprite("1buy"),
        pos(760,435),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "1buy"
    ])
    
    
    const oneBought = add([
        sprite("bought"),
        pos(760,435),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "1bought"
    ])
    
    const oneEquipped = add([
        sprite("equipped"),
        pos(760,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons"
    ])
    
    const oneEquip = add([
        sprite("equip"),
        pos(760,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "oneEquip"
    ])
    
    const twoBuy = add([
        sprite("2buy"),
        pos(1130,435),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "2buy"
    ])
    
    const twoBought = add([
        sprite("bought"),
        pos(1130,435),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "2bought"
    ])
    
    const twoEquipped = add([
        sprite("equipped"),
        pos(1130,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons"
    ])
    
    const twoEquip = add([
        sprite("equip"),
        pos(1130,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "twoEquip"
    ])
    
    const threeBuy = add([
        sprite("3buy"),
        pos(1503,435),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "3buy"
    ])
    
    const threeBought = add([
        sprite("bought"),
        pos(1503,435),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "3bought"
    ])
    
    const threeEquipped = add([
        sprite("equipped"),
        pos(1503,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons"
    ])
    
    const threeEquip = add([
        sprite("equip"),
        pos(1503,485),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "threeEquip"
    ])
    
    const fourBuy = add([
        sprite("4buy"),
        pos(576,805),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "4buy"
    ])
    
    const fourBought = add([
        sprite("bought"),
        pos(576,805),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "4bought"
    ])
    
    const fourEquipped = add([
        sprite("equipped"),
        pos(576,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons"
    ])
    
    const fourEquip = add([
        sprite("equip"),
        pos(576,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "fourEquip"
    ])
    
    const heartBuy = add([
        sprite("2buy"),
        pos(963,805),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "heartBuy"
    ])
    
    const heartBought = add([
        sprite("bought"),
        pos(963,805),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "heartBought"
    ])
    
    const heartEquipped = add([
        sprite("equipped"),
        pos(963,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "heartEquipped"
    ])
    
    const heartEquip = add([
        sprite("equip"),
        pos(963,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "heartEquip"
    ])
    
    const coinsBuy = add([
        sprite("5buy"),
        pos(1363.5,805),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "buttons",
        "coinsBuy"
    ])
    
    const coinsBought = add([
        sprite("bought"),
        pos(1363.5,805),
        origin("center"),
        scale(1.6),
        area(),
        layer("buttons"),
        "coinsBought",
        "buttons",
    ])
    
    const coinsEquipped = add([
        sprite("equipped"),
        pos(1363.5,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "coinsEquipped"
    ])
    
    const coinsEquip = add([
        sprite("equip"),
        pos(1363.5,855),
        origin("center"),
        scale(1.6),
        layer("buttons"),
        area(),
        "buttons",
        "coinsEquip"
    ])
    
    const exitIcon = add([
        sprite("exit"),
        pos(1665,75),
        origin("center"),
        scale(0.3),
        area(),
        color(136, 8, 7),
        "buttons",
        "exitIcon"
    ])
    
    coinsEquipped.hidden=true;
    heartEquipped.hidden=true;
    fourEquipped.hidden=true;
    threeEquipped.hidden=true;
    twoEquipped.hidden=true;
    oneEquipped.hidden=true;
    defEquip.hidden=true;
    coinsBought.hidden=true;
    threeBought.hidden=true;
    twoBought.hidden=true;
    oneBought.hidden=true;
    fourBought.hidden=true;
    heartBought.hidden=true;
    
    
    
    
    onClick("exitIcon",(exit)=>{
        music.pause()
        go("menu")
    })
    
    
    onUpdate(()=>{
        if(heartOwned==true){heartBuy.hidden=true;
    heartBought.hidden=false;}
    
    if(fourOwned==true){fourBuy.hidden=true;
    fourBought.hidden=false;}
    if(threeOwned==true){threeBuy.hidden=true;
    threeBought.hidden=false;}
    
    if(twoOwned==true){twoBuy.hidden=true;
    twoBought.hidden=false;}
    if(oneOwned==true){oneBuy.hidden=true;
    oneBought.hidden=false;}
    if(coinsOwned==true){coinsBuy.hidden=true;
    coinsBought.hidden=false;}
    })
    
    onClick("heartBuy", (heartBuy)=>{
        if(heartOwned==true){shake(1)}
    if(heartOwned==false){
    if(getData("coins")>=500){
    heartOwned=true;
    setData("coins",getData("coins")-500)
    setData("heartOwned",true)
    oldCoins=oldCoins-500;
    heartBuy.hidden=true;
    heartBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{
        shake(1)
    }}
    });
    
    onClick("4buy", (fourBuy)=>{
        if(fourOwned==true){shake(1)}
        if(fourOwned==false){
    if(getData("coins")>=10000){
    fourOwned=true;
    setData("coins",getData("coins")-10000)
    setData("fourOwned",true)
    oldCoins=oldCoins-10000;
    fourBuy.hidden=true;
    fourBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{shake(1)
    }}
    });
    
    onClick("3buy", (threeBuy)=>{
        if(threeOwned==true){shake(1)}
        if(threeOwned==false){
    if(getData("coins")>=1000){
    threeOwned=true;
    setData("coins",getData("coins")-1000)
    oldCoins=oldCoins-1000;
    setData("threeOwned",true)
    threeBuy.hidden=true;
    threeBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{shake(1)
    }}
    });
    
    onClick("coinsBuy", (coinsBuy)=>{
        if(coinsOwned==true){shake(1)}
    if(coinsOwned==false){
    if(getData("coins")>=650){
    coinsOwned=true;
    setData("coins",getData("coins")-650)
    setData("coinsOwned",true)
    oldCoins=oldCoins-650;    
    coinsBuy.hidden=true;
    coinsBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{shake(1)
    }}
    });
    
    onClick("2buy", (twobuy)=>{
        if(twoOwned==true){shake(1)}
     if(twoOwned==false){
    if(getData("coins")>=500){
    twoOwned=true;
    setData("coins",getData("coins")-500)
    setData("twoOwned",true)
    oldCoins=oldCoins-500;
    twoBuy.hidden=true;
    twoBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{shake(1)
    }}
    });
    
    onClick("1buy", (onebuy)=>{
    if(oneOwned==true){shake(1)}
    if(oneOwned==false){
    if(getData("coins")>=150){
    oneOwned=true;
    setData("coins",getData("coins")-150)
    setData("oneOwned",true)
    //debug.log(oneOwned)
    oldCoins=oldCoins-150;
    onebuy.hidden=true;
    oneBought.hidden=false;
    coinsLabel.text=oldCoins;
    if(SFXsoundOn=true){
        play("coinPick")
    }
    }
    else{shake(1)
    }}
    });
    
    
    onClick("heartEquip",(heartEquip)=>{
    if(heartOwned==true){
        if(heartUpgrade==true){shake(1)}
    else{
        heartUpgrade=true;
        heartEquip.hidden=true;
        heartEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    }
    else{shake(1)}
    })
    
    onClick("coinsEquip",(coinsEquip)=>{
        //debug.log(coinsUpgrade)
    if(coinsOwned==true){
        if(coinsUpgrade==true){shake(1)}
    else{
        coinsUpgrade=true;
        coinsEquip.hidden=true;
        coinsEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }}
    else{shake(1)}
    })
    
    
    
    
    onClick("defEquip",(defEquip)=>{
        if(skin==0){shake(1)}
    else{
        skin=0;
        setData("skin",skin)
        defEquip.hidden=true;
        defEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    
    })
    
    
    onClick("oneEquip",(oneEquip)=>{
        if(skin==1){shake(1)}
    else{
    if(oneOwned==true){
        skin=1;
        setData("skin",skin)
        oneEquip.hidden=true;
        oneEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    
    else{
        shake(1)
    }}
    })
    
    onClick("twoEquip",(twoEquip)=>{
    if(skin==2){shake(1)}
    else{
    if(twoOwned==true){
        skin=2;
        setData("skin",skin)
        twoEquip.hidden=true;
        twoEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    
    else{
        shake(1)
    }}
    })
    
    onClick("threeEquip",(threeEquip)=>{
        if(skin==3){shake(1)}
    else{
    if(threeOwned==true){
        skin=3;
        setData("skin",skin)
        threeEquip.hidden=true;
        threeEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    
    else{
        shake(1)
    }}
    })
    
    onClick("fourEquip",(fourEquip)=>{
        //debug.log(skin)
        if(skin==4){shake(1)}
    else{
    if(fourOwned==true){
        skin=4;
        setData("skin",skin)
        fourEquip.hidden=true;
        fourEquipped.hidden=false;
        if(SFXsoundOn==true){
            play("coinPick")
        }
    }
    
    else{
        shake(1)
    }}
    })
    
    
    onUpdate(()=>{
    
    if(heartUpgrade==true){
        heartEquip.hidden=true;
        heartEquipped.hidden=false;
    }
    
    if(coinsUpgrade==true){
        coinsEquip.hidden=true;
        coinsEquipped.hidden=false;
    }
    
        if(skin==0){
            defEquipped.hidden=false;
            defEquip.hidden=true;
            oneEquip.hidden=false;
            oneEquipped.hidden=true;
            twoEquip.hidden=false;
            twoEquipped.hidden=true;
            threeEquip.hidden=false;
            threeEquipped.hidden=true;
            fourEquip.hidden=false;
            fourEquipped.hidden=true;
        }
    else if(skin==1){
            oneEquip.hidden=true;
            oneEquipped.hidden=false;
            defEquipped.hidden=true;
            defEquip.hidden=false;
            twoEquip.hidden=false;
            twoEquipped.hidden=true;
            threeEquip.hidden=false;
            threeEquipped.hidden=true;
            fourEquip.hidden=false;
            fourEquipped.hidden=true;
        }
    
        else if(skin==2){
            defEquipped.hidden=true;
            defEquip.hidden=false;
            oneEquip.hidden=false;
            oneEquipped.hidden=true;
            twoEquip.hidden=true;
            twoEquipped.hidden=false;
            threeEquip.hidden=false;
            threeEquipped.hidden=true;
            fourEquip.hidden=false;
            fourEquipped.hidden=true;
        }
    
        else if(skin==3){
            defEquipped.hidden=true;
            defEquip.hidden=false;
            oneEquip.hidden=false;
            oneEquipped.hidden=true;
            twoEquip.hidden=false;
            twoEquipped.hidden=true;
            threeEquip.hidden=true;
            threeEquipped.hidden=false;
            fourEquip.hidden=false;
            fourEquipped.hidden=true;
        }
    
        else if(skin==4){
            defEquipped.hidden=true;
            defEquip.hidden=false;
            oneEquip.hidden=false;
            oneEquipped.hidden=true;
            twoEquip.hidden=false;
            twoEquipped.hidden=true;
            threeEquip.hidden=false;
            threeEquipped.hidden=true;
            fourEquip.hidden=true;
            fourEquipped.hidden=false;
        }
    })
    
    
    
    
    
    
    const coinIcon= add([
            sprite("coin"),
            layer("ui"),
            scale("0.1"),
            pos(5,22)
            ])
    
                //coinsLabel.destroy()
            const coinsLabel = add([
        text(oldCoins,{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(64, 24),
        layer("ui"),
    ])
    
    /*const coinsKLabel = add([
        text(Math.round(oldCoins/100) / 10+"k",{
            size:50,
            width:300,
            font:"sinko",
        }),
        pos(64, 24),
        layer("ui"),
    ])
    coinsKLabel.hidden=true;
    
    if(oldCoins>1000){
        coinsLabel.hidden=true;
        coinsKLabel.hidden=false;
    }
    
    if(oldCoins<1000){
        coinsLabel.hidden=false;
        coinsKLabel.hidden=true;
    }*/
    onHover("buttons",(button)=>{
                button.color = rgb(
                    128, 126, 121
                )
    
            wait(0.00000000001,()=>{
                button.color=rgb()
                exitIcon.color=rgb(136, 8, 7)
            })
            
            })
    
        });
    
    go("oldVer")
    
    
    </script>
